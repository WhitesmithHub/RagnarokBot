{"file_contents":{"main.py":{"content":"import os\nimport asyncio\nfrom aiogram import Bot, Dispatcher, types\nfrom aiogram.filters import Command\nfrom openai import OpenAI\n\n# Загружаем токены из переменных окружения (Secrets в Replit)\nBOT_TOKEN = os.getenv(\"BOT_TOKEN\")\nOPENAI_API_KEY = os.getenv(\"OPENAI_API_KEY\")\n\nbot = Bot(token=BOT_TOKEN)\ndp = Dispatcher()\nclient = OpenAI(api_key=OPENAI_API_KEY)\n\nSYSTEM_PROMPT = \"\"\"\nТы — мастер текстовой RPG в стиле Dungeons & Dragons и Ragnarok Online.\nПравила:\n- Игроки выбирают класс и имя, бот ведёт их через сюжет.\n- Всегда показывай окно «УМЕНИЯ» перед выбором.\n- Действия игрока имеют риск, никогда не раскрывай последствия заранее.\n- Бой проходит по кубам (d20 атака, XdY урон).\n- Никогда не делай игрока бессмертным.\n\"\"\"\n\n\n@dp.message(Command(\"start\"))\nasync def start(message: types.Message):\n    await message.answer(\n        \"Добро пожаловать в Ragnarok RPG!\\nНапиши /new чтобы создать персонажа.\"\n    )\n\n\n@dp.message(Command(\"new\"))\nasync def new(message: types.Message):\n    await message.answer(\n        \"Введите пол, класс и имя персонажа.\\nНапример: Мужчина, Мечник, Альберт.\"\n    )\n\n\n@dp.message()\nasync def chat_with_ai(message: types.Message):\n    user_text = message.text\n\n    response = client.responses.create(model=\"gpt-4.1-mini\",\n                                       input=[{\n                                           \"role\": \"system\",\n                                           \"content\": SYSTEM_PROMPT\n                                       }, {\n                                           \"role\": \"user\",\n                                           \"content\": user_text\n                                       }])\n\n    await message.answer(response.output_text)\n\n\nasync def main():\n    await dp.start_polling(bot)\n\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\nфш","size_bytes":2165},"pyproject.toml":{"content":"[project]\nname = \"python-template\"\nversion = \"0.1.0\"\ndescription = \"\"\nauthors = [\"Your Name <you@example.com>\"]\nrequires-python = \">=3.11\"\ndependencies = []\n","size_bytes":157}},"version":1}